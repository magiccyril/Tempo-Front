"use strict";window.cookieconsent_options={message:"En poursuivant la navigation sur ce site, vous acceptez l’utilisation de cookies pour disposer de services adaptés à vos attentes.",dismiss:"J'accepte",learnMore:"Plus d'infos",link:null,theme:"css/app.c714648b.css"},moment.locale("fr",{months:"Janvier_Février_Mars_Avril_Mai_Juin_Juillet_Août_Septembre_Octobre_Novembre_Décembre".split("_"),monthsShort:"janv._févr._mars_avr._mai_juin_juil._août_sept._oct._nov._déc.".split("_"),weekdays:"Dimanche_Lundi_Mardi_Mercredi_Jeudi_Vendredi_Samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"Di_Lu_Ma_Me_Je_Ve_Sa".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:"[Aujourd'hui à] LT",nextDay:"[Demain à] LT",nextWeek:"dddd [à] LT",lastDay:"[Hier à] LT",lastWeek:"dddd [dernier à] LT",sameElse:"L"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"une année",yy:"%d années"},ordinal:function(a){return a+(1===a?"er":"ème")},week:{dow:1,doy:4}}),angular.module("tempoApp",["ngSanitize","ngTouch","divonaNgMandrill","divonaNgEdf"]),angular.module("tempoApp").constant("CONTACT_SUBJECT","Tempo").constant("CONTACT_SENDTO_EMAIL","cyril@18ruedivona.eu").constant("CONTACT_SENDTO_NAME","Cyril").constant("MANDRILL_APIKEY","vE7Jt7oEhNU4rJEa75HjIg"),angular.module("tempoApp").constant("CALENDAR_MIN_DATE","2004-09-01").controller("MainCtrl",["$scope","CALENDAR_MIN_DATE","divonaNgEdf.Forecast","divonaNgEdf.Tempo","divonaNgEdf.Ejp","Settings",function(a,b,c,d,e,f){a.onCalendarTypeClick=function(){a.showCalendarType=!a.showCalendarType},a.onCalendarTypeChange=function(){a.showCalendarType=!1,a.calendarLoadData(),window.ga&&ga("send","event","calendar-type","change",a.calendarType,{nonInteraction:!0})},a.calendarTypeFormat=function(a){switch(a){case"tempo":return"Tempo";case"ejp-north":return"EJP Nord";case"ejp-paca":return"EJP PACA";case"ejp-west":return"EJP Ouest";case"ejp-south":return"EJP Sud"}},a.calendarLoadData=function(){switch(a.calendarType){case"tempo":d.getMonth(a.calendarDate).then(function(b){a.calendarEvents=b});break;case"ejp-north":e.getMonthByZone("north",a.calendarDate).then(function(b){a.calendarEvents=b});break;case"ejp-paca":e.getMonthByZone("paca",a.calendarDate).then(function(b){a.calendarEvents=b});break;case"ejp-west":e.getMonthByZone("west",a.calendarDate).then(function(b){a.calendarEvents=b});break;case"ejp-south":e.getMonthByZone("south",a.calendarDate).then(function(b){a.calendarEvents=b})}},a.changeMonth=function(c){var d=!c.isBefore(b);d&&(a.calendarDate=c,a.previousMonth=moment(c).subtract(1,"month"),a.nextMonth=moment(c).add(1,"month"),a.previousYear=moment(c).subtract(1,"year"),a.nextYear=moment(c).add(1,"year"),a.today=moment(),a.calendarLoadData(),window.ga&&ga("send","event","calendar-date","change",c.format("YYYY/MM/DD"),{nonInteraction:!0}))},a.showCalendarType=!1,a.calendarType="tempo",a.changeMonth(moment()),a.calendarEvents=[],a.todayDate=moment(),a.tomorrowDate=moment().add(1,"days"),moment().hours>0&&moment.hours<6&&(a.todayDate.subtract(1,"days"),a.tomorrowDate.subtract(1,"days")),d.getCounter().then(function(b){a.tempoCounter=b}),e.getCounter().then(function(b){a.ejpCounter=b}),c.fetch().then(function(b){a.forecast=b,f.themeColor.set(b.today.tempo.raw),a.themeCss=f.themeCSS.set(b.today.tempo.raw)})}]),angular.module("tempoApp").controller("HeadCtrl",["$scope","Settings",function(a,b){a.$on("themeColorUpdate",function(){a.themeColor=b.themeColor.get()})}]),angular.module("tempoApp").controller("ContactCtrl",["$scope","Mandrill","CONTACT_SUBJECT","CONTACT_SENDTO_EMAIL","CONTACT_SENDTO_NAME",function(a,b,c,d,e){a.contactStatus={connected:!1,error:void 0,pending:!1,sent:!1},b.ping().then(function(){a.contactStatus.connected=!0},function(){a.contactStatus.connected=!1}),a.name="",a.email="",a.message="",a.onContactFormSubmit=function(){var f={subject:c,text:a.message,from_email:a.email,from_name:a.name,to:[{email:d,name:e,type:"to"}]};a.contactStatus.pending=!0,b.sendMessage(f).then(function(){a.contactStatus.pending=!1,a.contactStatus.sent=!0},function(){a.contactStatus.pending=!1,a.contactStatus.error=!0}),window.ga&&ga("send","event","contact","send",a.email,{nonInteraction:!0})},a.resetForm=function(){a.contactStatus.sent=!1,a.message=""}}]),angular.module("tempoApp").factory("Settings",["$rootScope",function(a){function b(){return f}function c(b){switch(b){case"red":f="#d32a0e";break;case"white":f="#cecece";break;default:f="#006687"}return a.$broadcast("themeColorUpdate"),f}function d(){return g}function e(b){switch(b){case"red":g="site-title-red";break;case"white":g="site-title-white";break;default:g="site-title-blue"}return a.$broadcast("themeCSSUpdate"),g}var f="#006687",g="site-title-blue";return{themeColor:{get:b,set:c},themeCSS:{get:d,set:e}}}]),angular.module("tempoApp").directive("calendar",[function(){return{link:function(a){function b(b){for(var c=moment(b).startOf("month").startOf("week"),d=moment(b).endOf("month").endOf("week"),e=Math.ceil((d.diff(c,"days")+1)/7),f=c.clone(),g={},h=0;e>h;h++){g[h]=[];for(var i=0;7>i;i++){var j="-",k=f.month()===b.month(),l="empty";k||(l="out"),a.events[f.format("YYYY-MM-DD")]&&(l=a.events[f.format("YYYY-MM-DD")].raw,"boolean"==typeof a.events[f.format("YYYY-MM-DD")].raw&&(l=a.events[f.format("YYYY-MM-DD")].raw?"red":"white"),j=a.events[f.format("YYYY-MM-DD")].formated),g[h].push({date:f,format:f.format("D"),isGoodMonth:k,data:j,cssClass:l}),f=f.add(1,"days")}}return g}a.$watch("date",function(){a.calendar=b(a.date)}),a.$watch("events",function(){a.calendar=b(a.date)})},restrict:"E",scope:{date:"=date",events:"=ngModel"},templateUrl:"views/directives/calendar.html"}}]),angular.module("tempoApp").directive("ejpForecastItem",[function(){return{link:function(a,b){var c=function(){b.attr({"class":"",title:"Jour non déterminé"}),a.model&&!0===a.model.raw&&b.attr({"class":"forecast-ejp-item-ejp",title:"Jour EJP"}),a.model&&!1===a.model.raw&&b.attr({"class":"forecast-ejp-item-not",title:"Jour non EJP"})};a.$watch("model",c)},restrict:"A",scope:{model:"=ngModel"},templateUrl:"views/directives/ejpForecastItem.html",transclude:!0}}]);
